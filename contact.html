<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5LTTX2TGVQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5LTTX2TGVQ');
    gtag('config', 'AW-17346642053');
  </script>
  
  <!-- Event snippet for Submit lead form (1) conversion page -->
  <script>
    function gtag_report_conversion(url) {
      var callback = function () {
        if (typeof(url) != 'undefined') {
          window.location = url;
        }
      };
      gtag('event', 'conversion', {
        'send_to': 'AW-17346642053/djvHCNG48f4aEIWBw89A',
        'value': 0.0,
        'currency': 'USD',
        'event_callback': callback
      });
      return false;
    }
  </script>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact Us - Roast Portal</title>
  <meta name="description" content="Get in touch with Roast Portal. We're here to help with your coffee questions and subscription needs." />
  <link rel="icon" type="image/svg+xml" href="images/bean-favicon.svg"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/clean.css">
  <style>
    /* Additional styles for contact page */
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html {
      scroll-behavior: smooth;
    }
    
    body {
      background: linear-gradient(180deg, 
        #FFFFFF 0%, 
        #FBFBFD 20%, 
        #F8F9FB 50%, 
        #FBFBFD 80%, 
        #FFFFFF 100%
      );
      color: var(--text-primary);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      min-height: 100vh;
    }
    
    /* Main Content Styles */
    .main-content {
      max-width: 800px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }
    
    .page-title {
      font-size: 2.5rem;
      font-weight: var(--font-weight-bold);
      text-align: center;
      margin-bottom: 1rem;
      color: var(--text-primary);
    }
    
    .page-subtitle {
      font-size: 1.125rem;
      text-align: center;
      margin-bottom: 3rem;
      color: var(--text-secondary);
    }
    
    .contact-container {
      display: flex;
      justify-content: center;
    }
    
    .contact-form {
      background: var(--bg-primary);
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 600px;
    }
    
    .contact-form h2 {
      font-size: 1.5rem;
      font-weight: var(--font-weight-bold);
      margin-bottom: 1.5rem;
      color: var(--text-primary);
      border-bottom: 2px solid var(--accent-blue);
      padding-bottom: 0.5rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }
    
    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: var(--font-weight-bold);
      color: var(--text-primary);
    }
    
    .form-input, .form-textarea, .form-select {
      width: 100%;
      border: 1px solid #E5E5E7;
      border-radius: 0.5rem;
      padding: 0.75rem;
      font-size: 1rem;
      font-family: inherit;
      transition: border-color var(--ease-apple);
      background: white;
    }
    
    .form-input:focus, .form-textarea:focus, .form-select:focus {
      outline: none;
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.1);
    }
    
    .form-textarea {
      resize: vertical;
      min-height: 120px;
    }
    
    .form-button {
      width: 100%;
      background: var(--accent-blue);
      color: white;
      padding: 1rem;
      border-radius: 0.5rem;
      font-weight: var(--font-weight-bold);
      font-size: 1rem;
      border: none;
      cursor: pointer;
      transition: background-color var(--ease-apple);
    }
    
    .form-button:hover {
      background: #0056b3;
    }
    
    .form-button:active {
      transform: translateY(1px);
    }
    
    /* Footer Styles */
    .site-footer {
      background: var(--bg-secondary);
      border-top: 1px solid #E5E5E7;
      padding: 2rem 0;
      margin-top: 2rem;
    }
    
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    
    .footer-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }
    
    .footer-logo {
      display: flex;
      align-items: center;
      text-decoration: none;
      transition: transform var(--ease-apple);
      font-weight: var(--font-weight-bold);
      color: var(--text-primary);
    }
    
    .footer-logo:hover {
      transform: scale(1.05);
    }
    
    .logo-text {
      font-size: 1.125rem;
      font-weight: var(--font-weight-bold);
      color: var(--accent-blue);
      letter-spacing: 0.025em;
    }
    
    .footer-copyright {
      color: var(--text-secondary);
      font-size: 0.875rem;
      text-align: center;
      margin: 0;
    }
    
    .footer-links {
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .footer-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.875rem;
      transition: color var(--ease-apple);
    }
    
    .footer-link:hover {
      color: var(--text-primary);
    }
    
    /* Responsive adjustments */
    @media (min-width: 768px) {
      .contact-container {
        grid-template-columns: 1fr 1fr;
      }
      
      .footer-content {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
      
      .footer-section {
        align-items: flex-start;
      }
      
      .footer-links {
        justify-content: flex-end;
      }
    }
    
    @media (max-width: 767px) {
      .form-row {
        grid-template-columns: 1fr;
      }
    }

    /* FAQ Section Styles */
    .faq-section {
      background: #f8f9fa;
      padding: 4rem 0;
      margin-top: 2rem;
    }

    .faq-item {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .faq-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
    }

    .faq-question {
      color: var(--color-primary);
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      line-height: 1.4;
    }

    .faq-answer {
      color: var(--text-secondary);
      line-height: 1.6;
      margin: 0;
    }
  </style>
</head>
<body>
  <main class="main-content">
    <h1 class="page-title">Contact Us</h1>
    <p class="page-subtitle">We'd love to hear from you. Get in touch with our coffee experts.</p>
    
    <div class="contact-container">
      <div class="contact-form">
        <h2>Send us a Message</h2>
        <!-- Hidden iframe to receive the form POST -->
        <iframe id="formSink" name="formSink" style="display:none;"></iframe>

        <form id="contactForm"
              action="https://script.google.com/macros/s/AKfycbyuuoHLme_YQQChx3JCOFVcyz4H0e_oMpNn-OnzzZAEj_iMIxciVAVub2OJdZPmBGUN/exec"
              method="POST"
              target="formSink"
              novalidate>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="firstName">First Name *</label>
              <input id="firstName" name="firstName" type="text" class="form-input" required />
            </div>
            <div class="form-group">
              <label class="form-label" for="lastName">Last Name *</label>
              <input id="lastName" name="lastName" type="text" class="form-input" required />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="email">Email Address *</label>
            <input id="email" name="email" type="email" class="form-input" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="subject">Subject *</label>
            <select id="subject" name="subject" class="form-select" required>
              <option value="">Select a topic</option>
              <option>Subscription Question</option>
              <option>Order Status</option>
              <option>Coffee & Brewing</option>
              <option>Technical Support</option>
              <option>Feedback</option>
              <option>Other</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label" for="message">Message *</label>
            <textarea id="message" name="message" class="form-textarea" placeholder="Tell us how we can help..." required></textarea>
          </div>

          <!-- Honeypot -->
          <div class="form-group" aria-hidden="true" style="position:absolute;left:-9999px;opacity:0;">
            <label for="hp">Leave this blank</label>
            <input id="hp" name="hp" type="text" tabindex="-1" autocomplete="off">
          </div>

          <!-- Tracking fields (populated by JS) -->
          <input type="hidden" name="pagePath" id="pagePath">
          <input type="hidden" name="referrer" id="referrer">
          <input type="hidden" name="userAgent" id="userAgent">
          <input type="hidden" name="gclid" id="gclid">
          <input type="hidden" name="utm_source" id="utm_source">
          <input type="hidden" name="utm_medium" id="utm_medium">
          <input type="hidden" name="utm_campaign" id="utm_campaign">
          <input type="hidden" name="utm_term" id="utm_term">
          <input type="hidden" name="utm_content" id="utm_content">

          <!-- Location fields (new) -->
          <input type="hidden" name="timezone" id="timezone">
          <input type="hidden" name="lat" id="lat">
          <input type="hidden" name="lng" id="lng">
          <input type="hidden" name="accuracy_m" id="accuracy_m">
          <input type="hidden" name="loc_source" id="loc_source">
          <input type="hidden" name="city" id="city">
          <input type="hidden" name="region" id="region">
          <input type="hidden" name="country" id="country">
          <input type="hidden" name="ip" id="ip">

          <button type="submit" id="submitBtn" class="form-button">Send Message</button>
          <p id="formStatus" class="page-subtitle" style="display:none;margin-top:1rem;"></p>
        </form>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="faq-section" id="faq">
      <div class="main-content">
        <h2 class="page-title">Frequently Asked Questions</h2>
        
        <div class="faq-item">
          <h3 class="faq-question">How does Any Brew work?</h3>
          <p class="faq-answer">Any Brew uses AI to create personalized coffee blends based on your taste preferences. Simply take our quiz, and we'll craft a custom blend just for you.</p>
        </div>

        <div class="faq-item">
          <h3 class="faq-question">What's included in my subscription?</h3>
          <p class="faq-answer">Each delivery includes 15 pre-dosed cups of your personalized blend, complete with brewing instructions tailored to your equipment.</p>
        </div>

        <div class="faq-item">
          <h3 class="faq-question">How often will I receive deliveries?</h3>
          <p class="faq-answer">We deliver fresh coffee every two weeks, ensuring you always have the perfect cup ready to brew.</p>
        </div>

        <div class="faq-item">
          <h3 class="faq-question">Can I change my preferences?</h3>
          <p class="faq-answer">Absolutely! Your blend evolves based on your feedback. Rate each cup and tell us what you'd like to adjust.</p>
        </div>

        <div class="faq-item">
          <h3 class="faq-question">What if I don't like my blend?</h3>
          <p class="faq-answer">We're confident you'll love it, but if you're not satisfied, we'll work with you to perfect your blend or provide a full refund.</p>
        </div>

        <div class="faq-item">
          <h3 class="faq-question">Do you ship internationally?</h3>
          <p class="faq-answer">Currently, we ship within the United States. International shipping is coming soon!</p>
        </div>
      </div>
    </div>
  </main>
  
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <a class="logo" href="index.html">Any Brew<sup>™</sup><br><span class="logo-brand">by ROAST PORTAL</span></a>
        <nav class="footer-links">
          <a href="contact.html">FAQ</a>
          <a href="terms.html">Terms</a>
          <a href="privacy.html">Privacy</a>
          <a href="javascript:void(0)" class="btn btn--primary" onclick="return gtag_report_conversion('quiz.html');">Subscribe now</a>
        </nav>
      </div>
    </div>
  </footer>
  
  <script>
    // --- COMPREHENSIVE CONTACT PAGE TRACKING ---
    
    // Track page view and contact form start
    function trackPageView() {
      try {
        if (typeof gtag === 'function') {
          gtag('event', 'page_view', {
            page_title: document.title,
            page_location: window.location.href,
            page_path: window.location.pathname,
            custom_parameter: 'contact_page'
          });
          // Track contact form start
          gtag('event', 'contact_form_start', {
            page_title: document.title,
            page_location: window.location.href
          });
        }
      } catch (error) {
        console.error('Page view tracking error:', error);
      }
    }
    
    // Track form field interactions
    function trackFormInteraction(fieldName, fieldType, action, value = '') {
      try {
        if (typeof gtag === 'function') {
          gtag('event', 'form_interaction', {
            field_name: fieldName,
            field_type: fieldType,
            action: action, // 'focus', 'blur', 'change', 'input'
            field_value: value.substring(0, 50), // Truncate for privacy
            page_title: document.title,
            timestamp: Date.now()
          });
        }
      } catch (error) {
        console.error('Form interaction tracking error:', error);
      }
    }
    
    // Track form validation errors
    function trackValidationError(fieldName, errorType, errorMessage) {
      try {
        if (typeof gtag === 'function') {
          gtag('event', 'validation_error', {
            field_name: fieldName,
            error_type: errorType,
            error_message: errorMessage,
            page_title: document.title,
            timestamp: Date.now()
          });
        }
      } catch (error) {
        console.error('Validation error tracking error:', error);
      }
    }
    
    // Track form submission attempts
    function trackFormSubmission(attemptNumber, success = false, errorMessage = '') {
      try {
        if (typeof gtag === 'function') {
          gtag('event', 'form_submission', {
            attempt_number: attemptNumber,
            success: success,
            error_message: errorMessage,
            page_title: document.title,
            timestamp: Date.now()
          });
        }
      } catch (error) {
        console.error('Form submission tracking error:', error);
      }
    }
    
    // Track FAQ interactions
    function trackFAQInteraction(question, action) {
      try {
        if (typeof gtag === 'function') {
          gtag('event', 'faq_interaction', {
            question: question,
            action: action, // 'expand', 'collapse'
            page_title: document.title,
            timestamp: Date.now()
          });
        }
      } catch (error) {
        console.error('FAQ interaction tracking error:', error);
      }
    }
    
    // Track time on page
    let contactStartTime = Date.now();
    function trackTimeOnPage() {
      const timeOnPage = Math.round((Date.now() - contactStartTime) / 1000);
      try {
        if (typeof gtag === 'function') {
          gtag('event', 'time_on_page', {
            time_seconds: timeOnPage,
            page_title: document.title,
            page_location: window.location.href
          });
        }
      } catch (error) {
        console.error('Time on page tracking error:', error);
      }
    }
    
    // Initialize tracking
    document.addEventListener('DOMContentLoaded', function() {
      trackPageView();
      
      // Track time on page every 30 seconds
      setInterval(trackTimeOnPage, 30000);
      
      // Track form field interactions
      document.querySelectorAll('input, textarea, select').forEach(field => {
        field.addEventListener('focus', () => {
          trackFormInteraction(field.name, field.type, 'focus', field.value);
        });
        
        field.addEventListener('blur', () => {
          trackFormInteraction(field.name, field.type, 'blur', field.value);
        });
        
        field.addEventListener('change', () => {
          trackFormInteraction(field.name, field.type, 'change', field.value);
        });
        
        field.addEventListener('input', () => {
          trackFormInteraction(field.name, field.type, 'input', field.value);
        });
      });
      
      // Track FAQ interactions
      document.querySelectorAll('.faq-question').forEach(question => {
        question.addEventListener('click', () => {
          const isExpanded = question.parentElement.classList.contains('active');
          trackFAQInteraction(question.textContent.trim(), isExpanded ? 'collapse' : 'expand');
        });
      });
    });
    
    // Populate tracking fields
    (function initHiddenFields(){
      const qs = new URLSearchParams(location.search);
      const set = (id, val) => { const el = document.getElementById(id); if (el) el.value = val ?? ''; };
      set('pagePath', location.pathname);
      set('referrer', document.referrer || '');
      set('userAgent', navigator.userAgent);
      ['gclid','utm_source','utm_medium','utm_campaign','utm_term','utm_content'].forEach(k => {
        const el = document.getElementById(k);
        if (el) el.value = qs.get(k) || '';
      });
      set('timezone', Intl.DateTimeFormat().resolvedOptions().timeZone);
    })();

    // Geolocation (precise) with fallback to IP (coarse)
    async function getPreciseGeo(timeoutMs=2500) {
      if (!('geolocation' in navigator)) return null;
      return new Promise(resolve => {
        navigator.geolocation.getCurrentPosition(
          p => resolve({ lat: p.coords.latitude, lng: p.coords.longitude, acc: p.coords.accuracy }),
          () => resolve(null),
          { timeout: timeoutMs, maximumAge: 600000, enableHighAccuracy: true }
        );
      });
    }
    async function getIPInfo() {
      try {
        const r = await fetch('https://ipapi.co/json/');
        if (!r.ok) return null;
        const j = await r.json();
        return { lat: j.latitude, lng: j.longitude, city: j.city, region: j.region, country: j.country_name, ip: j.ip };
      } catch { return null; }
    }
    function setVal(id, v){ const el = document.getElementById(id); if (el) el.value = v ?? ''; }

    async function enrichLocation() {
      const g = await getPreciseGeo();
      if (g) {
        setVal('lat', g.lat?.toFixed(6));
        setVal('lng', g.lng?.toFixed(6));
        setVal('accuracy_m', Math.round(g.acc || 0));
        setVal('loc_source', 'geolocation');
        return;
      }
      const ip = await getIPInfo();
      if (ip) {
        setVal('lat', ip.lat);
        setVal('lng', ip.lng);
        setVal('city', ip.city);
        setVal('region', ip.region);
        setVal('country', ip.country);
        setVal('ip', ip.ip);
        setVal('loc_source', 'ip');
      }
    }

    // Pre-warm location on load
    enrichLocation();

    // Submit via hidden iframe and show thank-you on load
    const form = document.getElementById('contactForm');
    const iframe = document.getElementById('formSink');
    const btn = document.getElementById('submitBtn');
    const emailEl = document.getElementById('email');

    form.addEventListener('submit', async (e) => {
      // If you need to validate first, do it here, then:
      if (btn){ btn.disabled = true; btn.textContent = 'Sending…'; }
      // Give location one last short chance if not set
      if (!document.getElementById('loc_source').value) {
        await Promise.race([enrichLocation(), new Promise(res => setTimeout(res, 1200))]);
      }
      // Native submit (no CORS)
      // Note: don't call preventDefault; we WANT the browser to post the form.
    });

    if (iframe) {
      iframe.addEventListener('load', () => {
        const email = (emailEl?.value || '').trim();
        // Fire Google Ads conversion
        if (window.gtag) {
          gtag('event', 'conversion', {
            'send_to': 'AW-17346642053/djvHCNG48f4aEIWBw89A',
            'value': 0.0,
            'currency': 'USD'
          });
        }
        // Swap UI
        form.innerHTML = `
          <div style="text-align:center;padding:2rem 1rem">
            <h3 style="font-weight:700;margin-bottom:0.5rem;">Thanks — we got your message!</h3>
            <p class="page-subtitle" style="margin:0 auto;max-width:34ch;">
              Our team will reply to <b>${email || 'your email'}</b> shortly.
            </p>
          </div>
        `;
      });
    }
  </script>
</body>
</html>
